<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lean Kaizen Knowledge Base</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Prompt', sans-serif;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://img5.pic.in.th/file/secure-sv1/-99656d04010176bc1.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            filter: blur(8px);
            z-index: -1;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link.active {
            background-color: #06b6d4; /* cyan-500 */
            color: white;
            font-weight: 700;
            box-shadow: 0 4px 14px 0 rgba(6, 182, 212, 0.39);
        }
        .nav-link:not(.active):hover {
            background-color: #ecfeff; /* cyan-50 */
            color: #0891b2; /* cyan-600 */
            transform: translateX(4px);
        }
        .content-card {
            transition: opacity 0.5s ease-in-out;
            background-color: rgba(255, 255, 255, 0.9);
        }
        @supports (backdrop-filter: blur(16px)) or (-webkit-backdrop-filter: blur(16px)) {
            .content-card {
                background-color: rgba(255, 255, 255, 0.7);
                -webkit-backdrop-filter: blur(16px);
                backdrop-filter: blur(16px);
            }
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FF9933;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        .gradient-text {
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        .btn-primary {
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(6, 182, 212, 0.4);
        }
        .interactive-card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .interactive-card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 max-w-5xl fade-in-up">
        <!-- Header -->
        <header class="text-center mb-8 bg-white/50 backdrop-blur-sm rounded-lg p-4">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold gradient-text">Lean Kaizen Knowledge Center</h1>
            <p class="text-base sm:text-lg text-gray-700 mt-2">ศูนย์ความรู้เพื่อการปรับปรุงอย่างต่อเนื่อง</p>
        </header>

        <div class="flex flex-col md:flex-row gap-8">
            <!-- Navigation -->
            <nav class="w-full md:w-1/4">
                <ul class="bg-white/75 backdrop-blur-sm rounded-lg shadow-md p-4 sticky top-8">
                    <li><a href="#" class="nav-link block w-full text-left p-3 rounded-md mb-2 active" data-target="page1">Lean Kaizen คืออะไร?</a></li>
                    <li><a href="#" class="nav-link block w-full text-left p-3 rounded-md mb-2" data-target="page2">แก่นของ Lean และ Kaizen</a></li>
                    <li><a href="#" class="nav-link block w-full text-left p-3 rounded-md mb-2" data-target="page3">หลักการสำคัญ</a></li>
                    <li><a href="#" class="nav-link block w-full text-left p-3 rounded-md mb-2" data-target="page4">ทำไมต้องใช้ Lean Kaizen?</a></li>
                    <li><a href="#" class="nav-link block w-full text-left p-3 rounded-md mb-2" data-target="page5">ร่วมแชร์ไอเดีย Kaizen</a></li>
                </ul>
            </nav>

            <!-- Content -->
            <main class="w-full md:w-3/4">
                <!-- Page 1: What is Lean Kaizen? -->
                <div id="page1" class="content-card p-4 md:p-6 lg:p-8 rounded-lg shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold mb-4 flex items-center gap-3" style="color: #FF9933;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <span>Lean Kaizen คืออะไร?</span>
                    </h2>
                    <div class="border-l-4 border-cyan-500 pl-4">
                        <p class="text-base md:text-lg leading-relaxed">
                            Lean Kaizen คือแนวคิดในการ <span class="font-semibold text-cyan-700">"ปรับปรุงอย่างต่อเนื่อง"</span> (Continuous Improvement) โดยมีเป้าหมายหลักเพื่อลดความสูญเปล่าและเพิ่มประสิทธิภาพในการทำงานให้สูงสุด
                        </p>
                    </div>
                     <!-- Image -->
                    <div class="mt-6 flex justify-center">
                        <img src="https://img5.pic.in.th/file/secure-sv1/ChatGPT-Image-15-..-2568-12_52_28.png" alt="ChatGPT Image 15 ก.ย. 2568 12 52 28" class="rounded-lg shadow-md w-2/3 h-auto object-cover">
                    </div>
                </div>

                <!-- Page 2: Core Concepts -->
                <div id="page2" class="content-card p-4 md:p-6 lg:p-8 rounded-lg shadow-lg hidden">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 flex items-center gap-3" style="color: #FF9933;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                        </svg>
                        <span>แก่นของ Lean และ Kaizen</span>
                    </h2>
                    <div class="space-y-6">
                        <div class="bg-cyan-50/50 p-4 sm:p-6 rounded-lg border border-cyan-200 interactive-card-hover">
                            <h3 class="text-xl md:text-2xl font-semibold mb-2" style="color: #FF9933;">Lean (ลีน)</h3>
                            <p class="text-base md:text-lg leading-relaxed">
                                มุ่งเน้นไปที่การ <span class="font-bold">ลดความสูญเปล่า</span> หรือสิ่งที่ไม่จำเป็นในกระบวนการทำงานทั้งหมด เช่น การรอคอย, การเคลื่อนที่ที่ซ้ำซ้อน, หรือการผลิตที่มากเกินไป
                            </p>
                        </div>
                        <div class="bg-teal-50/50 p-4 sm:p-6 rounded-lg border border-teal-200 interactive-card-hover">
                            <h3 class="text-xl md:text-2xl font-semibold mb-2" style="color: #FF9933;">Kaizen (ไคเซ็น)</h3>
                            <p class="text-base md:text-lg leading-relaxed">
                                เน้นการ <span class="font-bold">ปรับปรุงอย่างค่อยเป็นค่อยไป</span> และทำอย่างสม่เสมอ เริ่มต้นจากการเปลี่ยนแปลงเล็ก ๆ น้อย ๆ ที่สามารถทำได้ในทุกวัน เพื่อนำไปสู่ผลลัพธ์ที่ยิ่งใหญ่ในระยะยาว
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Page 3: Key Principles -->
                <div id="page3" class="content-card p-4 md:p-6 lg:p-8 rounded-lg shadow-lg hidden">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 flex items-center gap-3" style="color: #FF9933;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                        </svg>
                        <span>หลักการสำคัญของ Lean Kaizen</span>
                    </h2>
                    <ul class="space-y-6">
                        <li class="flex items-start interactive-card-hover p-4 rounded-lg">
                            <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-cyan-100 text-cyan-600 flex items-center justify-center mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold text-xl">ไปดูหน้างานจริง (Gemba)</h3>
                                <p class="text-gray-700">การลงพื้นที่เพื่อสังเกตการณ์จริงจะช่วยให้เข้าใจปัญหาและความสูญเปล่าที่แท้จริงได้ดีกว่าการดูเพียงแค่รายงาน</p>
                            </div>
                        </li>
                        <li class="flex items-start interactive-card-hover p-4 rounded-lg">
                             <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-cyan-100 text-cyan-600 flex items-center justify-center mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h5M20 20v-5h-5M4 20L20 4" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold text-xl">ปรับเล็ก ๆ แต่ต่อเนื่อง</h3>
                                <p class="text-gray-700">เริ่มต้นจากปัญหาเล็ก ๆ ที่สามารถแก้ไขได้ทันที เช่น การจัดวางอุปกรณ์หรือการจัดระเบียบพื้นที่</p>
                            </div>
                        </li>
                        <li class="flex items-start interactive-card-hover p-4 rounded-lg">
                             <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-cyan-100 text-cyan-600 flex items-center justify-center mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold text-xl">ทุกคนมีส่วนร่วม</h3>
                                <p class="text-gray-700">ส่งเสริมให้พนักงานทุกระดับมีส่วนร่วมในการเสนอแนวคิดและลงมือแก้ไขปัญหาด้วยตัวเอง</p>
                            </div>
                        </li>
                        <li class="flex items-start interactive-card-hover p-4 rounded-lg">
                             <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-cyan-100 text-cyan-600 flex items-center justify-center mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-semibold text-xl">ใช้ข้อมูลตัดสินใจ</h3>
                                <p class="text-gray-700">การปรับปรุงควรตั้งอยู่บนข้อมูลที่เป็นจริงและสามารถวัดผลได้ เพื่อให้การแก้ไขมีประสิทธิภาพ</p>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Page 4: Why use Lean Kaizen? -->
                <div id="page4" class="content-card p-4 md:p-6 lg:p-8 rounded-lg shadow-lg hidden">
                    <h2 class="text-2xl md:text-3xl font-bold mb-4 flex items-center gap-3" style="color: #FF9933;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                        </svg>
                        <span>ทำไมต้องใช้ Lean Kaizen?</span>
                    </h2>
                    <p class="mb-6 text-base md:text-lg">Lean Kaizen ไม่ใช่แค่เครื่องมือ แต่เป็นแนวคิดที่ช่วยให้องค์กรเติบโตและปรับตัวได้อย่างยั่งยืน การนำ Lean Kaizen มาใช้จะส่งผลดีในหลายด้าน ดังนี้:</p>
                    <div class="space-y-6 mb-8">
                        <div class="p-4 bg-gray-50/50 rounded-lg border-l-4 border-cyan-500 interactive-card-hover">
                            <h4 class="font-bold text-base md:text-lg flex items-center gap-2" style="color: #FF9933;">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                                </svg>
                                <span>ลดต้นทุนและเพิ่มคุณภาพ (Reduce Cost & Increase Quality)</span>
                            </h4>
                            <p class="text-gray-700 mt-1">การค้นหาและกำจัดความสูญเปล่า 7 ประการ เช่น การผลิตเกินความจำเป็น, การรอคอย, หรือการขนส่งที่ไม่จำเป็น จะช่วยลดค่าใช้จ่ายในการดำเนินงานอย่างชัดเจน พร้อมทั้งลดความผิดพลาดและงานที่ต้องทำซ้ำ ทำให้สินค้าหรือบริการมีคุณภาพสูงขึ้น</p>
                        </div>
                        <div class="p-4 bg-gray-50/50 rounded-lg border-l-4 border-cyan-500 interactive-card-hover">
                            <h4 class="font-bold text-base md:text-lg flex items-center gap-2" style="color: #FF9933;">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <span>เพิ่มความพึงพอใจและความภักดีของลูกค้า (Increase Customer Satisfaction & Loyalty)</span>
                            </h4>
                            <p class="text-gray-700 mt-1">เมื่อกระบวนการทำงานมีประสิทธิภาพมากขึ้น ลูกค้าจะได้รับสินค้าและบริการที่รวดเร็ว ตรงเวลา และมีคุณภาพตามที่คาดหวัง ซึ่งจะนำไปสู่ความเชื่อมั่นและความภักดีในระยะยาว</p>
                        </div>
                        <div class="p-4 bg-gray-50/50 rounded-lg border-l-4 border-cyan-500 interactive-card-hover">
                            <h4 class="font-bold text-base md:text-lg flex items-center gap-2" style="color: #FF9933;">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                                <span>สร้างวัฒนธรรมการทำงานแบบมีส่วนร่วม (Build a Culture of Engagement)</span>
                            </h4>
                            <p class="text-gray-700 mt-1">Kaizen ส่งเสริมให้พนักงานทุกคนมีโอกาสในการเสนอแนวคิดและแก้ไขปัญหาในส่วนงานของตัวเอง ทำให้พวกเขารู้สึกว่าตนเองมีคุณค่าและเป็นเจ้าของงาน ซึ่งช่วยสร้างบรรยากาศการทำงานที่เป็นบวกและแข็งแกร่ง</p>
                        </div>
                        <div class="p-4 bg-gray-50/50 rounded-lg border-l-4 border-cyan-500 interactive-card-hover">
                            <h4 class="font-bold text-base md:text-lg flex items-center gap-2" style="color: #FF9933;">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                   <path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                                </svg>
                                <span>เพิ่มความคล่องตัวและขีดความสามารถในการแข่งขันระยะยาว (Enhance Agility & Long-term Competitiveness)</span>
                            </h4>
                            <p class="text-gray-700 mt-1">การปรับปรุงอย่างต่อเนื่องทำให้องค์กรไม่หยุดนิ่งและพร้อมรับมือกับความท้าทายใหม่ ๆ ได้ตลอดเวลา ช่วยให้องค์กรสามารถคิดค้นนวัตกรรมและปรับตัวให้เข้ากับตลาดที่เปลี่ยนแปลงได้อย่างรวดเร็ว</p>
                        </div>
                    </div>

                    <div class="bg-gray-100/50 p-4 md:p-6 rounded-lg">
                        <h3 class="text-xl md:text-2xl font-bold text-gray-800 mb-2">บทสรุป</h3>
                        <p class="text-base md:text-lg leading-relaxed">
                            หัวใจสำคัญของ Lean Kaizen คือการสร้าง "นิสัย" ของการทำงานให้ดีขึ้นในทุกวัน เริ่มจากสิ่งเล็ก ๆ และทำอย่างสม่เสมอ ซึ่งจะนำไปสู่การเปลี่ยนแปลงที่ยิ่งใหญ่และยั่งยืนสำหรับทั้งองค์กรและตัวคุณเอง
                        </p>
                    </div>

                    <div class="text-center mt-8">
                         <button id="share-idea-btn" class="bg-cyan-600 text-white font-bold py-3 px-8 rounded-full hover:bg-cyan-700 text-base md:text-lg shadow-lg btn-primary">
                            ร่วมตอบคำถามและแชร์ Lean Kaizen ของคุณ
                         </button>
                    </div>
                </div>
                
                <!-- Page 5: Share Ideas -->
                <div id="page5" class="content-card p-4 md:p-6 lg:p-8 rounded-lg shadow-lg hidden">
                    <div class="text-center bg-yellow-100/75 border-l-4 border-yellow-500 text-yellow-800 p-4 mb-6 rounded-r-lg">
                        <h2 class="text-xl md:text-2xl font-bold mb-2 flex items-center justify-center gap-3" style="color: #FF9933;">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V7a2 2 0 012-2h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V8z" />
                            </svg>
                            <span>ร่วมกิจกรรมแชร์ไอเดีย Kaizen!</span>
                        </h2>
                        <p>ตัวอย่าง Lean Kaizen ของท่านใดได้รับผลโหวตเยอะที่สุด ทาง HR มีรางวัลให้เล็กๆน้อยๆ เพียงเข้าร่วมกิจกรรม</p>
                    </div>

                    <form id="idea-form" class="space-y-6">
                        <div>
                            <label for="employee-id" class="block text-base md:text-lg font-medium text-gray-700 mb-2">รหัสพนักงาน</label>
                            <input type="text" id="employee-id" name="employee-id" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition" placeholder="กรุณากรอกรหัสพนักงานของคุณ" required>
                        </div>
                         <div>
                            <label for="user-name" class="block text-base md:text-lg font-medium text-gray-700 mb-2">ชื่อผู้ส่ง</label>
                            <input type="text" id="user-name" name="user-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition" placeholder="กรุณากรอกชื่อของคุณ" required>
                        </div>
                        <div>
                            <label for="experience" class="block text-base md:text-lg font-medium text-gray-700 mb-2">1. คุณเคยทำ Lean Kaizen หรือไม่ และยกตัวอย่างที่ทำ Kaizen ช่วยคุณได้อย่างไร?</label>
                            <textarea id="experience" name="experience" rows="5" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition" required></textarea>
                        </div>
                        <div>
                            <label for="process-improvement" class="block text-base md:text-lg font-medium text-gray-700 mb-2">2. ในหน่วยงานของคุณ คุณคิดว่า process ขั้นตอนไหนที่คุณคิดว่าควรจะนำมาเป็น Lean Kaizen ที่จะใช้งานในการลดกระบวนการทำงานของคุณ?</label>
                            <textarea id="process-improvement" name="process-improvement" rows="5" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition" required></textarea>
                        </div>
                        <div class="flex flex-col sm:flex-row justify-end items-center gap-4 pt-4">
                             <button type="button" id="view-ideas-btn" class="w-full sm:w-auto bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 transition-colors duration-300 btn-primary">
                                ดูความคิดเห็นของเพื่อน
                            </button>
                            <button type="submit" class="w-full sm:w-auto bg-cyan-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-cyan-700 shadow-md btn-primary">
                                ส่งคำตอบ
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Page 6: Admin Panel -->
                <div id="page6" class="content-card p-4 md:p-6 lg:p-8 rounded-lg shadow-lg hidden">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 flex items-center gap-3" style="color: #FF9933;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                        <span>Admin Panel - จัดการความคิดเห็น</span>
                    </h2>
                    <div id="comments-list" class="space-y-4">
                        <!-- Loading spinner -->
                        <div class="flex justify-center items-center h-40">
                            <div class="loader"></div>
                        </div>
                    </div>
                </div>

                <!-- Page 7: View All Ideas -->
                <div id="page7" class="content-card p-4 md:p-6 lg:p-8 rounded-lg shadow-lg hidden">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 flex items-center gap-3" style="color: #FF9933;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                        </svg>
                        <span>ไอเดีย Kaizen ทั้งหมด (ร่วมโหวต!)</span>
                    </h2>
                    <div id="all-ideas-list" class="space-y-4">
                        <!-- Loading spinner -->
                        <div class="flex justify-center items-center h-40">
                            <div class="loader"></div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Admin Panel Corner Link -->
    <a href="#" id="admin-link-corner" data-target="page6" class="nav-link fixed bottom-4 left-4 bg-white p-2 px-4 rounded-full shadow-lg text-red-600 hover:bg-red-50 hover:shadow-xl transition-all duration-300 z-50 text-sm font-semibold border border-gray-200">
        Admin
    </a>

    <!-- Password Modal -->
    <div id="password-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm m-4">
            <h3 class="text-xl font-bold mb-4">Admin Access</h3>
            <p class="text-gray-600 mb-4">กรุณาใส่รหัสผ่านเพื่อดำเนินการต่อ</p>
            <div class="relative">
                <input type="password" id="password-input" class="w-full p-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500" placeholder="รหัสผ่าน...">
                <button id="toggle-password" type="button" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700">
                    <svg id="eye-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                    <svg id="eye-slash-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.866 3.866M21 21L17.134 17.134" />
                    </svg>
                </button>
            </div>
            <p id="password-error" class="text-red-500 text-sm mt-2 hidden">รหัสผ่านไม่ถูกต้อง กรุณาลองอีกครั้ง</p>
            <div class="mt-6 flex justify-end gap-4">
                <button id="modal-cancel-btn" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300 transition">ยกเลิก</button>
                <button id="modal-submit-btn" class="bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700 transition btn-primary">ยืนยัน</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast-notification" class="fixed bottom-5 right-5 bg-gray-800 text-white py-2 px-5 rounded-lg shadow-lg opacity-0 translate-y-3 transition-all duration-300">
        <p>This is a toast message.</p>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwKRgiy3GfrGsXOLcakNTxYexHmnZJ_UhvsE-c_oW0rGCipOtzjKBzzEmzW8rWHTMSU/exec'; 

            const navLinks = document.querySelectorAll('.nav-link');
            const contentCards = document.querySelectorAll('.content-card');
            const shareIdeaBtn = document.getElementById('share-idea-btn');
            const commentsList = document.getElementById('comments-list');
            const viewIdeasBtn = document.getElementById('view-ideas-btn');
            const allIdeasList = document.getElementById('all-ideas-list');
            const ideaForm = document.getElementById('idea-form');
            const toast = document.getElementById('toast-notification');
            const passwordModal = document.getElementById('password-modal');
            const passwordInput = document.getElementById('password-input');
            const modalSubmitBtn = document.getElementById('modal-submit-btn');
            const modalCancelBtn = document.getElementById('modal-cancel-btn');
            const passwordError = document.getElementById('password-error');
            const togglePasswordBtn = document.getElementById('toggle-password');
            const eyeIcon = document.getElementById('eye-icon');
            const eyeSlashIcon = document.getElementById('eye-slash-icon');
            
            let allIdeasData = [];

            function showToast(message, isSuccess = true) {
                toast.textContent = message;
                toast.className = `fixed bottom-5 right-5 text-white py-2 px-5 rounded-lg shadow-lg transition-all duration-300 ${isSuccess ? 'bg-green-600' : 'bg-red-600'}`;
                toast.classList.remove('opacity-0', 'translate-y-3');
                setTimeout(() => {
                    toast.classList.add('opacity-0', 'translate-y-3');
                }, 4000);
            }

            async function loadIdeas() {
                if (!SCRIPT_URL) {
                    console.error("SCRIPT_URL is not set.");
                    showToast("กรุณาตั้งค่า SCRIPT_URL ในไฟล์ HTML ก่อน", false);
                    allIdeasList.innerHTML = `<p class="text-center text-red-500">ไม่ได้ตั้งค่าการเชื่อมต่อ Google Sheets</p>`;
                    commentsList.innerHTML = `<p class="text-center text-red-500">ไม่ได้ตั้งค่าการเชื่อมต่อ Google Sheets</p>`;
                    return;
                }
                
                allIdeasList.innerHTML = `<div class="flex justify-center items-center h-40"><div class="loader"></div></div>`;
                commentsList.innerHTML = `<div class="flex justify-center items-center h-40"><div class="loader"></div></div>`;

                try {
                    const response = await fetch(SCRIPT_URL);
                    if (!response.ok) throw new Error('Failed to fetch data from Google Sheets.');
                    
                    const data = await response.json();
                    
                    if (Array.isArray(data)) {
                        allIdeasData = data;
                    } else {
                        console.error("Fetched data is not an array:", data);
                        allIdeasData = [];
                        if(data.error) {
                             showToast(`Error from backend: ${data.error}`, false);
                        }
                    }
                    
                    renderAllIdeas();
                    renderComments();
                } catch (error) {
                    console.error('Error loading ideas:', error);
                    showToast("ไม่สามารถโหลดข้อมูลได้", false);
                    allIdeasList.innerHTML = `<p class="text-center text-red-500">เกิดข้อผิดพลาดในการโหลดข้อมูล</p>`;
                    commentsList.innerHTML = `<p class="text-center text-red-500">เกิดข้อผิดพลาดในการโหลดข้อมูล</p>`;
                }
            }
            
            function renderComments() {
                if (!commentsList) return;
                
                if (!allIdeasData || allIdeasData.length === 0) {
                     commentsList.innerHTML = `<p class="text-center text-gray-500">ยังไม่มีความคิดเห็น</p>`;
                     return;
                }

                commentsList.innerHTML = ''; 
                allIdeasData.forEach(comment => {
                    const commentElement = document.createElement('div');
                    commentElement.className = 'p-4 border rounded-lg bg-gray-50/75 flex justify-between items-center transition-all duration-300 interactive-card-hover';
                    commentElement.dataset.rowIndex = comment.rowIndex;
                    commentElement.innerHTML = `
                        <div>
                            <p class="font-semibold text-gray-800">${comment.user || 'ไม่มีชื่อ'} <span class="text-sm font-normal text-gray-500">(ID: ${comment.employeeId})</span></p>
                            <p class="text-sm text-gray-600 mt-1">"${comment.experience}"</p>
                        </div>
                        <button class="delete-btn bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors shadow btn-primary">ลบ</button>
                    `;
                    commentsList.appendChild(commentElement);
                });
            }

            function renderAllIdeas() {
                if (!allIdeasList) return;

                if (!allIdeasData || allIdeasData.length === 0) {
                     allIdeasList.innerHTML = `<p class="text-center text-gray-500">ยังไม่มีไอเดียที่ถูกส่งเข้ามา</p>`;
                     return;
                }
                
                const votedIdeas = JSON.parse(localStorage.getItem('votedIdeas') || '[]');

                allIdeasData.sort((a, b) => b.votes - a.votes);
                allIdeasList.innerHTML = ''; 
                allIdeasData.forEach(comment => {
                    const ideaElement = document.createElement('div');
                    ideaElement.className = 'p-4 border rounded-lg bg-gray-50/75 flex flex-col sm:flex-row justify-between sm:items-center transition-all duration-300 interactive-card-hover';
                    ideaElement.dataset.rowIndex = comment.rowIndex;

                    const hasVoted = votedIdeas.includes(comment.rowIndex.toString());
                    
                    const voteButtonHTML = hasVoted 
                        ? `<button class="vote-btn bg-gray-400 text-white w-full px-2 py-2 rounded-full shadow cursor-not-allowed flex items-center justify-center gap-2" disabled>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                </svg>
                                <span>โหวตแล้ว</span>
                            </button>`
                        : `<button class="vote-btn bg-cyan-500 text-white w-full px-2 py-2 rounded-full hover:bg-cyan-600 shadow flex items-center justify-center gap-2 btn-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.787l.25.125a2 2 0 002.29-1.787v-5.43m3.08-1.721a.5.5 0 00-.616.057l-1.82 2.121a.5.5 0 00.616.706l1.82-2.121a.5.5 0 000-.763L12 8l-1.82-2.121a.5.5 0 00-.616.706l1.82 2.121z" />
                                </svg>
                                <span>โหวต</span>
                            </button>`;


                    ideaElement.innerHTML = `
                        <div class="flex-grow w-full sm:pr-4">
                            <p class="font-semibold text-gray-800">${comment.user || 'ไม่มีชื่อ'} <span class="text-sm text-gray-500 font-normal">(ID: ${comment.employeeId})</span></p>
                            <p class="text-gray-600 mt-1"><b>ไอเดีย:</b> "${comment.processImprovement}"</p>
                        </div>
                        <div class="text-center mt-4 sm:mt-0 sm:ml-4 flex-shrink-0 w-full sm:w-28">
                            ${voteButtonHTML}
                            <p class="text-xl font-bold text-cyan-700 mt-2">${comment.votes}</p>
                        </div>
                    `;
                    allIdeasList.appendChild(ideaElement);
                });
            }

            function showPage(targetId) {
                contentCards.forEach(card => card.classList.add('hidden'));
                navLinks.forEach(link => link.classList.remove('active'));
                
                const targetCard = document.getElementById(targetId);
                if (targetCard) targetCard.classList.remove('hidden');
                
                const targetLink = document.querySelector(`.nav-link[data-target="${targetId}"]`);
                if (targetLink) targetLink.classList.add('active');
            }
            
            function hidePasswordModal() {
                passwordModal.classList.add('hidden');
            }

            togglePasswordBtn.addEventListener('click', () => {
                const isPassword = passwordInput.type === 'password';
                passwordInput.type = isPassword ? 'text' : 'password';
                eyeIcon.classList.toggle('hidden', isPassword);
                eyeSlashIcon.classList.toggle('hidden', !isPassword);
            });

            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('data-target');

                    if (targetId === 'page6') {
                        passwordInput.value = '';
                        passwordError.classList.add('hidden');
                        passwordModal.classList.remove('hidden');
                        passwordInput.focus();
                    } else {
                        showPage(targetId);
                    }
                });
            });

            async function handleAdminLogin() {
                const enteredPassword = passwordInput.value.trim();
                if (!enteredPassword) return;

                modalSubmitBtn.disabled = true;
                modalSubmitBtn.innerHTML = `<div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>`;
                passwordError.classList.add('hidden');

                try {
                    const response = await fetch(SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({ action: 'checkPassword', password: enteredPassword }),
                        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    });
                    const result = await response.json();

                    if (result.success) {
                        hidePasswordModal();
                        showPage('page6');
                    } else {
                        passwordError.classList.remove('hidden');
                        passwordInput.value = '';
                        passwordInput.focus();
                    }
                } catch (error) {
                    console.error('Error verifying password:', error);
                    showToast('เกิดข้อผิดพลาดในการตรวจสอบรหัสผ่าน', false);
                } finally {
                    modalSubmitBtn.disabled = false;
                    modalSubmitBtn.textContent = 'ยืนยัน';
                }
            }
            
            modalSubmitBtn.addEventListener('click', handleAdminLogin);
            passwordInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') handleAdminLogin();
            });

            modalCancelBtn.addEventListener('click', hidePasswordModal);
            passwordModal.addEventListener('click', (e) => {
                if (e.target === passwordModal) hidePasswordModal();
            });
            
            shareIdeaBtn.addEventListener('click', (e) => {
                e.preventDefault();
                showPage('page5');
                document.querySelector('main').scrollIntoView({ behavior: 'smooth' });
            });

            viewIdeasBtn.addEventListener('click', (e) => {
                e.preventDefault();
                showPage('page7');
                loadIdeas();
                document.querySelector('main').scrollIntoView({ behavior: 'smooth' });
            });

            ideaForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                submitBtn.disabled = true;
                submitBtn.innerHTML = `<div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mx-auto"></div>`;

                const formData = new FormData(e.target);
                const data = {
                    action: 'submit',
                    employeeId: formData.get('employee-id'),
                    user: formData.get('user-name'),
                    experience: formData.get('experience'),
                    processImprovement: formData.get('process-improvement'),
                };

                try {
                    const response = await fetch(SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify(data),
                        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    });
                    const result = await response.json();

                    if(result.success) {
                        showToast('ส่งไอเดียของคุณสำเร็จแล้ว!');
                        e.target.reset();
                        loadIdeas();
                    } else {
                        throw new Error(result.message || 'Unknown error occurred.');
                    }
                } catch (error) {
                    console.error('Error submitting idea:', error);
                    showToast('เกิดข้อผิดพลาดในการส่งข้อมูล', false);
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ส่งคำตอบ';
                }
            });

            commentsList.addEventListener('click', async (e) => {
                const deleteBtn = e.target.closest('.delete-btn');
                if (deleteBtn) {
                    const commentElement = deleteBtn.closest('[data-row-index]');
                    if (commentElement && confirm('คุณแน่ใจหรือไม่ว่าต้องการลบความคิดเห็นนี้?')) {
                        const rowIndex = commentElement.dataset.rowIndex;
                        deleteBtn.disabled = true;
                        deleteBtn.textContent = '...';

                        try {
                             await fetch(SCRIPT_URL, {
                                method: 'POST',
                                body: JSON.stringify({ action: 'delete', rowIndex: rowIndex }),
                                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                            });
                            showToast('ลบความคิดเห็นสำเร็จ');
                            loadIdeas();
                        } catch (error) {
                            console.error('Error deleting comment:', error);
                            showToast('เกิดข้อผิดพลาดในการลบ', false);
                            deleteBtn.disabled = false;
                             deleteBtn.textContent = 'ลบ';
                        }
                    }
                }
            });

            allIdeasList.addEventListener('click', async (e) => {
                const voteButton = e.target.closest('.vote-btn');
                if (voteButton && !voteButton.disabled) {
                    const ideaElement = voteButton.closest('[data-row-index]');
                    const rowIndex = ideaElement.dataset.rowIndex;
                    
                    const votedIdeas = JSON.parse(localStorage.getItem('votedIdeas') || '[]');
                    if (votedIdeas.includes(rowIndex.toString())) {
                        showToast('คุณได้โหวตไอเดียนี้ไปแล้ว', false);
                        return; 
                    }

                    voteButton.disabled = true;
                    const originalButtonText = voteButton.innerHTML;
                    voteButton.innerHTML = `<div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mx-auto"></div>`;

                    try {
                        const response = await fetch(SCRIPT_URL, {
                            method: 'POST',
                            body: JSON.stringify({ action: 'vote', rowIndex: rowIndex }),
                            headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                        });
                         const result = await response.json();
                        if (!result.success) throw new Error(result.message);
                        
                        votedIdeas.push(rowIndex.toString());
                        localStorage.setItem('votedIdeas', JSON.stringify(votedIdeas));

                        const commentToUpdate = allIdeasData.find(c => c.rowIndex == rowIndex);
                        if(commentToUpdate) {
                            commentToUpdate.votes++;
                            renderAllIdeas(); 
                        }
                    } catch (error) {
                        console.error('Error voting:', error);
                        showToast('โหวตไม่สำเร็จ', false);
                        voteButton.disabled = false;
                        voteButton.innerHTML = originalButtonText;
                    }
                }
            });

            showPage('page1');
            loadIdeas();
        });
    </script>

</body>
</html>



